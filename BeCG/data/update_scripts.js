var rebootDelay=15,compteRebour=rebootDelay;function update_onload(){LANG=get_lang(),document.getElementById("file1").value="",document.getElementById("upload_form").addEventListener("submit",e=>{e.preventDefault(),uploadFile()}),document.getElementById("firmware-button").addEventListener("click",function(e){e.target.classList.add("selected"),document.getElementById("filesystem-button").classList.remove("selected"),document.getElementById("file1").name="firmware",LANG=="en"?document.getElementById("status").innerHTML="Firmware Upload":document.getElementById("status").innerHTML="Téléchargement du Firmware"}),document.getElementById("filesystem-button").addEventListener("click",function(e){e.target.classList.add("selected"),document.getElementById("firmware-button").classList.remove("selected"),document.getElementById("file1").name="filesystem",LANG=="en"?document.getElementById("status").innerHTML="Web application Upload":document.getElementById("status").innerHTML="Téléchargement de l'application web"}),document.getElementById("file1").addEventListener("change",function(){var t=document.getElementById("file1").files[0];t&&t.name?(document.getElementById("button-send").disabled=!1,document.getElementById("progressBar").value=0):document.getElementById("button-send").disabled=!0,document.getElementById("firmware-button").classList.contains("selected")?document.getElementById("status").innerHTML="Firmware Upload":document.getElementById("status").innerHTML="Web application Upload",document.getElementById("loaded_n_total").innerHTML=""})}function stringToBoolean(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function disableAll(){document.getElementById("overlay").style.display="block"}function enableAll(){document.getElementById("overlay").style.display="none"}function uploadFile(){var e,t=document.getElementById("file1").files[0],n=new FormData;n.append(document.getElementById("file1").name,t,t.name),e=new XMLHttpRequest,e.upload.addEventListener("progress",progressHandler,!1),e.addEventListener("load",completeHandler,!1),e.addEventListener("loadstart",startHandler,!1),e.addEventListener("error",errorHandler,!1),e.addEventListener("abort",abortHandler,!1),e.open("POST","/update"),e.setRequestHeader("Access-Control-Allow-Headers","*"),e.setRequestHeader("Access-Control-Allow-Origin","*"),e.send(n)}function progressHandler(e){LANG=="en"?document.getElementById("loaded_n_total").innerHTML="Sent "+e.loaded+" bytes of "+e.total:document.getElementById("loaded_n_total").innerHTML="Envoyés "+e.loaded+" octets sur "+e.total;var t=Math.round(e.loaded/e.total*100);document.getElementById("progressBar").value=t,LANG=="en"?document.getElementById("status").innerHTML=t+"% Uploaded... wait a few moments":document.getElementById("status").innerHTML=t+"% Téléchargé... patientez quelques instants"}function completeHandler(){enableAll(),LANG=="en"?document.getElementById("status").innerHTML="Upload successful.":document.getElementById("status").innerHTML="Téléchargement réussi.";var t,n=document.getElementById("dlgMask0"),s=document.getElementById("attente0");n.classList.remove("noshow"),s.classList.remove("noshow"),compteRebour=rebootDelay,document.getElementById("compte_a_rebour").innerHTML=compteRebour,setTimeout(function(){rebours()},1e3),t=rebootDelay*1e3+100,setTimeout(function(){document.location.replace("/")},t)}function startHandler(){disableAll()}function errorHandler(){enableAll(),LANG=="en"?document.getElementById("status").innerHTML="Upload error.":document.getElementById("status").innerHTML="Erreur du téléchargement."}function abortHandler(){enableAll(),LANG=="en"?document.getElementById("status").innerHTML="Upload canceled.":document.getElementById("status").innerHTML="Téléchargement annulé."}function rebours(){compteRebour=compteRebour-1,document.getElementById("compte_a_rebour").innerHTML=compteRebour,compteRebour>0&&setTimeout(function(){rebours()},1e3)}